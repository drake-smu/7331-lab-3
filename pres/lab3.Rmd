---
title: "Association Rules"
author: "Che Cobb, Andy Heroy, Carson Drake, David Josephs"
date: "`r Sys.Date()`"
output: 
  html_document:
    toc: TRUE
    toc_float:
      collapsed: true
      smooth_scroll: false
    theme: paper
    df_print: paged
    keep_md: TRUE

---

```{r setup, echo = F}

if (knitr::is_latex_output()) {
	knitr::opts_chunk$set(dev = "tikz")
}
knitr::opts_chunk$set(warning = F)
# knitr::opts_knit$set(root.dir = "..")
knitr::opts_chunk$set(message = F)
knitr::opts_chunk$set(tidy = T, tidy.opts = list(comment = F))
knitr::opts_chunk$set(fig.align = "center")
knitr::opts_chunk$set(comment = '#>')
knitr::opts_chunk$set(fig.path = 'fig/')
knitr::opts_knit$set(root.dir = rprojroot::find_rstudio_root_file())

```

```{r, include=F}
source("scripts/load-packages.R")
```

# Project Overview

Please we need to discuss project motivation and our experiment, just as Rida asked

Then we can begin our analysis

# Project Setup


# Business Understanding

* [10 points] Describe the purpose of the data set you selected (i.e., why was this data bcollected in the first place?). How will you measure the effectiveness of a good algorithm? Why does your chosen validation method make sense for this specific dataset and the stakeholders needs?

We chose this dataset from the UCI's machine learning repository for its categorical predictive attributes.  It contains 1994 Census data pulled from the US Census database.  The prediction task we've set forth is to predict if a person salary range is >50k in a 1994, based on the various categorical/numerical attributes in the census database. The link to the data source is below:

https://archive.ics.uci.edu/ml/datasets/census+income

The effectiveness of our algorithm will be determined by support, confidence and lift.  As these are the metrics that describe how strong a relationship between each element is with the other elements within each transaction.  Currently, there are no methods for cross validation of association rules, although there are some hard working individuals out there that are attempting to create such a tool.


# Data Understanding
* [10 points] Describe the meaning and type of data (scale, values, etc.) for each
attribute in the data file. Verify data quality: Are there missing values? Duplicate data? Outliers? Are those mistakes? How do you deal with these problems?
* [10 points] Visualize the any important attributes appropriately. Important: Provide an interpretation for any charts or graphs.

Here we will discuss each attribute and give some description about its ranges.
 
 
#### Categorical Attributes
  * workclass - Which business sector do they work in?
  * education - What level of education received?
  * marital_status - What is their marriage history
  * occupation - What do they do for a living
  * relationship - Family member relation
  * race - What is the subjects race
  * gender - What is the subjects gender
  * native_country - Where is the subject originally from
  * income_bracket - Do they make over or under 50k/year
 
#### Continuous Attributes
  * age - How old is the subject?
  * fnlwgt - Sampling weight of observation
  * education_num - numerical encoding of education variable
  * capital_gain - income from investment sources, separate from wages/salary
  * capital_loss - losses from investment sources, separate from wages/salary
  * hours_per_week - How many hours a week did they work?
  
# Setup


First, lets go ahead and load up necessary libraries:

```{r libraries, tidy=F,eval=FALSE, code = readLines('../scripts/load-packages.R')}
```


```{r, echo = F}
# read in chunks here
read_chunk('analysis/preprocessing.R')
read_chunk('analysis/Lab3Start.R')
```

Next, lets import our dataset

```{r dataimport}
```

## Data Quality Inspection

The first thing we must do is check and see if there are any NAs in our dataset, just to make sure to not mess up our analysis.

```{r dataqual}
```


## Data Cleaning

Looks like we are doing ok here. The next issue we have in the dataset, is because of the way the csv was stored, some of the levels in our factors include leading and trailing whitespace. This is highly undesirable, so we must clean it up:

```{r factorclean}
```

Next, we need to reencode our data as factors. First, lets encode the education levels into factors with larger groups (for example 1st-12th grade should be no diploma, not a bunch of levels).

```{r edubin}
```

Then the the income brackets:

```{r incbrack}
```

Next, lets change the `?` levels to something more useful:

```{r questionmark}
lapply(data[GetFactors(data)], FixLevels)
```


Next, lets remove the fnlwgt, education number, and capital gain and loss columns, as they are unneeded. We also need to rename some columns to be easier for us, and use the `cut` function to factorize our numeric variables

```{r cleanup}
```

Lets see the results:

```{r preprocessres}
```

# EDA

We'd also like to get a quick feel for the dataset through some visulizations.

```{r EDAGraphs}
```

####-TODO-Discuss graphs

Finally, we can set up our dataset to be the proper data format for the Apriori algorithm:

```{r transact}
str(data$hoursperweek)
```


# Modeling and Evaluation

* Different tasks will require different evaluation methods. Be as thorough as possible when analyzing the data you have chosen and use visualizations of the results to explain the performance and expected outcomes whenever possible. Guide the reader through your analysis with plenty of discussion of the results. For this task, we chose Option B: Association Rule Mining.

Option B: Association Rule Mining
• Create frequent itemsets and association rules.
• Use tables/visualization to discuss the found results.
• Use several measure for evaluating how interesting different rules are.
• Describe your results. What findings are the most compelling and why?

Before we begin with our analysis, lets check out the rule frequencies within the dataset. We are looking for rules with `support >= .2`

```{r rulefreq}
```


# Rule mining

Next, lets mine some rules with the apriori algorithm, and then clean up redundant rules. We are still sorting out what to set the minsupp and minconf to.

```{r rulemine}
```

## Rule quality and inspection

Next, let us inspect the rules, and examine their quality

```{r quality}
```

## Plots

First lets view a scatterplot of our rules

```{r scatterplot}
```

Next lets look at  a balloon plot

```{r baloonplot}
```

Parallel plot

```{r plplot}
```

Two key plot

```{r kplot}
```

grouped plot

```{r gplot}
```

# alternate rule mining

```{r redux}
```

## Inspection

```{r inspec}
```

## Plotting

```{r plot2}
```

```{r bplo2}
```


```{r kplo2}
```

```{r gplo2}
```

# Deployment
Be critical of your performance and tell the reader how you current model might be usable by other parties. Did you achieve your goals? If not, can you reign in the utility of your modeling?

• How useful is your model for interested parties (i.e., the companies or organizations that might want to use it)?
• How would your deploy your model for interested parties?
• What other data should be collected?
• How often would the model need to be updated, etc.?

# Exceptional Work
